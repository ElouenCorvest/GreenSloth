# Shedding Light On Blue-Green Photosynthesis
## A Wavelength-Dependent Mathematical Model Of Photosynthesis In *Synechocystis* sp. PCC 6803

Welcome to the Photosynthesis Mathematical Model Repository! This repository contains code and notebooks that implement a Ordinary Differential Equation (ODE)-based model of photosynthesis. The model aims to simulate various aspects of the photosynthetic process in cyanobacteria, providing insights into the underlying mechanisms and dynamics.

### Description

Our model description captures the major enzymes, complexes, and metabolites that define *Synechocystis* photosynthesis, including linear, cyclic and water-water electron flows, respiration and lumped sink reactions such as the Calvin Benson Bassham (CBB) cycle and Photorespiration (PR).
The model uses a full-spectrum (visible) light description (400 nm - 700 nm) to capture the effect of different light colours on the PETC.
It considers important adaptive processes like state transitions and Non-Photochemical Quenching (NPQ) via the Orange Carotenoid Protein (OCP).

The model is implemented in Python, using **modelbase** package for modular construction of kinetic models (Van Aalst, [doi: 10.1186/s12859-021-04122-7](https://doi.org/10.1186/s12859-021-04122-7)).

![An image showing the reactions included in the model](Figures/model_scheme.png "Overview over the model")
<sub>Abbreviations: 2PG: 2-phosphoglycolate, 3PGA: 3-phosphoglycerate, ADP: Adenosine diphosphate, ATP: Adenosine triphosphate, ATPsynth: ATP synthase, CBB: Calvin-Benson-Bassham cycle, CCM: Carbon Concentrating Mechanism, COX(aa3): Cytochrome c oxidase, Cyd(bd): Cytochrome bd quinol oxidase, Cyto b6f: Cytochrome b6f complex, FNR: Ferredoxin-NADP+ Reductase, Fd: Ferredoxin, NADP+: Nicotinamide adenine dinucleotide phosphate, NADPH: reduced NADP, NAD+: Nicotinamide adenine dinucleotide, NADH: reduced NAD, NDH-2: NAD(P)H Dehydrogenase complex 2, OCP: Orange Carotenoid Protein, Oxy: RuBisCO oxygenation, PC: Plastocyanine, PQ: Plastoquinone, PR: Photorespiration, PSI: Photosystem I, PSII: Photosystem II, SDH: Succinate dehydrogenase

## Contents
1. [Notebooks](Notebooks/): This directory contains two Jupyter notebooks that demonstrate the implementation of the mathematical model and i) reproduce all the figures presented in related publications, and ii) provides additional analysis performed in response to Reviewers comments and suggestions.
2. [Code](Code/): This directory contains the source code of the mathematical model, organized into modular components for easy understanding and customization.
3. [Figures](Figures/): This directory contains model schemes, as well as figures generated by the notebooks. The latter showcase the results and visualizations obtained from running the model simulations.
3. [Environment YAML](environment.yml): This repository also includes a YAML file (environment.yml) specifying the conda environment required to run the code and notebooks seamlessly.
4. README.md

## Usage
To explore the notebooks and reproduce the figures:

1. Clone this repository to your local machine.
2. Navigate to the `Notebooks` directory.
3. Open the notebooks using Jupyter Notebook or JupyterLab.
4. Follow the instructions within the notebooks to run the code cells and generate the figures.

To set up the conda environment:
1. Make sure you have conda installed.
2. Navigate to the root directory of the repository.
3. Run the following command to create the conda environment:
```console
conda env create -f environment.yml
```
4. Activate the environment:
```console
conda activate synphot
```
5. Now you can run the notebooks without worrying about missing dependencies.


## Dependencies

The code and notebooks in this repository require the following dependencies:

- Python (version X.X.X)
- NumPy (version X.X.X)
- Matplotlib (version X.X.X)
- [Additional libraries, if any]

## How to cite
You can cite this work by referencing the latest publication:

**Shedding Light On Blue-Green Photosynthesis: A Wavelength-Dependent Mathematical Model Of Photosynthesis In *Synechocystis* sp. PCC 6803**<br>
Tobias Pfennig, Elena Kullmann, Tomáš Zavřel, Andreas Nakielski, Oliver Ebenhöh, Jan Červený, Gábor Bernát, Anna Matuszyńska
bioRxiv 2023.06.30.547186; doi: https://doi.org/10.1101/2023.06.30.547186

An archived version of this project is also deposited on Zenodo with the DOI https://doi.org/10.5281/zenodo.8186124

## How to Raise Issues

If you encounter any problems, have questions, or would like to provide feedback, please feel free to contact <tobias.pfennig@rwth-aachen.de> directly or raise an issue. To ensure that your issue is addressed promptly and effectively, please follow these guidelines:

1. **Check Existing Issues**: Before raising a new issue, please check if a similar issue has already been reported. This helps avoid duplicate issues and allows for better organization of discussions.

2. **Provide Details**: When raising an issue, provide as much detail as possible, including:
   - Description of the problem or question.
   - Steps to reproduce the issue (if applicable).
   - Expected behavior.
   - Any relevant error messages or screenshots.

3. **Be Courteous**: Please be respectful and courteous when interacting with others in the issue tracker. We value constructive feedback and aim to create a welcoming environment for all contributors.

4. **Use Labels**: To help categorize and prioritize issues, we use labels. If you're familiar with the project's labels, feel free to assign relevant labels to your issue. Otherwise, our maintainers will apply appropriate labels based on the content of the issue.

5. **Follow Up**: After raising an issue, please follow up if additional information is requested or if the problem is resolved. Your input is valuable in ensuring that issues are addressed in a timely manner.

To raise an issue, simply click on the "Issues" tab at the top of the repository and then click on the "New Issue" button. Fill out the provided form with the necessary details and submit your issue.

Thank you for your contribution to the project!

## Authors
#### Model development
- [Tobias Pfennig](https://www.cpbl.rwth-aachen.de/cms/CPBL/Die-Juniorprofessur/Unser/~wljpm/Tobias-Pfennig/) ([@TPfennig](https://gitlab.com/TPfennig))
- [Elena Kullmann](https://www.cpbl.rwth-aachen.de/cms/CPBL/Die-Juniorprofessur/Unser/~wljyq/Elena-Kullmann/) ([@elena_kullmann](https://gitlab.com/elena_kullmann))
- [Oliver Ebenhöh](https://www.qtb.hhu.de/qtb-team/qtb-team-details?tt_address%5Bfunktion%5D=18463&tt_address%5Bperson%5D=15524&cHash=17d4e241a639119e32e18dab9de14dc5) ([@ebenhoeh](https://gitlab.com/ebenhoeh))
- [Anna Matuszynska](https://www.cpbl.rwth-aachen.de/cms/CPBL/Die-Juniorprofessur/Unser/~sbfpr/Anna-Matuszy-324-ska/) ([@matuszynska](https://gitlab.com/matuszynska))

#### Analysis, experimental data and interpretation

- [Andreas Nakielski](https://www.cpbl.rwth-aachen.de/cms/CPBL/Die-Juniorprofessur/Unser/~ylubj/Andreas-Nakielski/) ([@AndreasNakielski](https://gitlab.com/AndreasNakielski))
- [Tomáš Zavřel](https://www.czechglobe.cz/en/contacts/144/)
- [Jan Červený](https://www.czechglobe.cz/en/contacts/145/)
- [Gábor Bernát](https://www.blki.hun-ren.hu/en/Gabor.BERNAT)

## License

[![CC BY 4.0][cc-by-shield]][cc-by]

This work is licensed under a
[Creative Commons Attribution 4.0 International License][cc-by].

[![CC BY 4.0][cc-by-image]][cc-by]

[cc-by]: http://creativecommons.org/licenses/by/4.0/
[cc-by-image]: https://i.creativecommons.org/l/by/4.0/88x31.png
[cc-by-shield]: https://img.shields.io/badge/License-CC%20BY%204.0-lightgrey.svg

## Project status

under revision
